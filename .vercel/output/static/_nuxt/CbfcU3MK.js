import{S as v}from"./C0gF2b3N.js";import{d as C}from"./CuqqTjF3.js";import{r as m,v as u,a2 as I,e as d,aG as x,aI as $,s as p,S as g,as as k}from"./DHK0-C8Z.js";function _(){let e=document.activeElement;if(e==null)return null;for(;e!=null&&e.shadowRoot!=null&&e.shadowRoot.activeElement!=null;)e=e.shadowRoot.activeElement;return e}function E(){const e=m(),c=u(()=>["#text","#comment"].includes(e.value?.$el.nodeName)?e.value?.$el.nextElementSibling:C(e));return{primitiveElement:e,currentElement:c}}const A="data-reka-collection-item";function b(e={}){const{key:c="",isProvider:M=!1}=e,f=`${c}CollectionProvider`;let t;if(M){const n=m(new Map);t={collectionRef:m(),itemMap:n},k(f,t)}else t=I(f);const R=(n=!1)=>{const l=t.collectionRef.value;if(!l)return[];const o=Array.from(l.querySelectorAll(`[${A}]`)),r=Array.from(t.itemMap.value.values()).sort((i,s)=>o.indexOf(i.ref)-o.indexOf(s.ref));return n?r:r.filter(i=>i.ref.dataset.disabled!=="")},h=d({name:"CollectionSlot",setup(n,{slots:l}){const{primitiveElement:o,currentElement:a}=E();return g(a,()=>{t.collectionRef.value=a.value}),()=>p(v,{ref:o},l)}}),w=d({name:"CollectionItem",inheritAttrs:!1,props:{value:{validator:()=>!0}},setup(n,{slots:l,attrs:o}){const{primitiveElement:a,currentElement:r}=E();return x(i=>{if(r.value){const s=$(r.value);t.itemMap.value.set(s,{ref:r.value,value:n.value}),i(()=>t.itemMap.value.delete(s))}}),()=>p(v,{...o,[A]:"",ref:a},l)}}),S=u(()=>Array.from(t.itemMap.value.values())),y=u(()=>t.itemMap.value.size);return{getItems:R,reactiveItems:S,itemMapSize:y,CollectionSlot:h,CollectionItem:w}}export{_ as g,b as u};
